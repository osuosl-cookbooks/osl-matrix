# Homeserver configuration for <%= @domain %>'s Matrix Synapse server

server_name: <%= @domain %>
pid_file: /data/homeserver.pid
#log_config: /data/logging.config
media_store_path: /data/media_store
report_stats: false
listeners:
  - port: 8008
    tls: false
    type: http
    x_forwarded: true
    resources:
      - names: [client, federation]
        compress: false

<% if @sqlite -%>
database:
  name: sqlite3
  args:
    database: /data/homeserver-sqlite.db
<% else -%>
database:
  name: psycopg2
  args:
    user: <%= @pg_username %>
    password: <%= @pg_password %>
    database: <%= @pg_name %>
    host: <%= @pg_host %>
    cp_min: 5
    cp_max: 10
<% end -%>

<%if !@appservices.empty? -%>
app_service_config_files:
<% @appservices.each do |appname| -%>
  - /data/<%= appname %>.yaml
<% end -%>
<% end -%>

registration_shared_secret_path: /data/keys/registration.key
signing_key_path: /data/keys/singing.key

<%= @user_config %>
